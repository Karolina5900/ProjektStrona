{% extends 'base.html' %}

{% block content %}
<div>
    <!-- Iteracja po wszystkich ogłoszeniach -->
    {% for ad in ads %}
        <div class="ad-item">
            <h3>{{ ad.title }}</h3>

            <!-- Status ogłoszenia -->
            {% if ad.sold %}
                <p>❌ Sprzedane</p>
            {% else %}
                <p>✅ Dostępne</p>
            {% endif %}

            <p>{{ ad.description }}</p>

            <!-- Wyświetlanie kategorii -->
            <p><strong>Kategoria:</strong>
                {% for cat in ad.category %}
                    {{ cat.name }}{% if not loop.last %}, {% endif %}
                {% endfor %}
            </p>

            <!-- Wyświetlanie ceny -->
            <p><strong>Cena:</strong> {{ ad.price }} PLN</p>

            <!-- Formularz do zmiany statusu ogłoszenia -->
            <form method="post" action="{{ url_for('toggle_sold', ad_id=ad.id) }}">
                <button type="submit" class="btn btn-primary">
                    {% if ad.sold %}
                        Zmień na dostępne
                    {% else %}
                        Zmień na sprzedane
                    {% endif %}
                </button>
            </form>
        </div>
    {% endfor %}
</div>

<div>
    <!-- Formularz do dodania nowego ogłoszenia -->
    <h2>Dodaj nowe ogłoszenie</h2>
    <form method="post" action="{{ url_for('add') }}">
        <div class="mb-3">
            <label class="form-label" for="item_text">Tytuł ogłoszenia</label>
            <input type="text" class="form-control" id="item_text" name="item_text" required>
        </div>
        <div class="mb-3">
            <label class="form-label" for="description">Opis ogłoszenia</label>
            <textarea class="form-control" id="description" name="description" required></textarea>
        </div>
        <div class="mb-3">
            <label class="form-label" for="category">Wybierz kategorię</label>
            <select name="category" class="form-control" id="category" required>
                {% for category in categories %}
                    <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label class="form-label" for="price">Cena</label>
            <input type="number" class="form-control" id="price" name="price" step="0.01" min="0" required>
        </div>
        <button type="submit" class="btn btn-success">Dodaj ogłoszenie</button>
    </form>
</div>
{% endblock %}
